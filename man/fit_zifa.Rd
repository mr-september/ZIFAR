% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/zifa.R
\name{fit_zifa}
\alias{fit_zifa}
\title{Fit ZIFA Model}
\usage{
fit_zifa(
  Y,
  k,
  max_iter = 100,
  tol = 0.01,
  single_sigma = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{Y}{Matrix of expression data (genes as rows, cells as columns)}

\item{k}{Integer specifying the number of latent dimensions}

\item{max_iter}{Maximum number of EM iterations (default: 100)}

\item{tol}{Convergence threshold for relative parameter change (default: 1e-2)}

\item{single_sigma}{If TRUE, estimate one noise variance for all genes (default: FALSE)}

\item{verbose}{If TRUE, print progress messages (default: TRUE)}
}
\value{
A list containing:
\item{Z}{Matrix of low-dimensional projections (cells x k dimensions)}
\item{model_params}{List of model parameters including A, mus, sigmas, and decay_coef}
\item{ll}{Vector of log-likelihood values per iteration}
\item{n_iter}{Number of iterations until convergence}
}
\description{
Implements Zero-Inflated Factor Analysis for dimensionality reduction
of zero-inflated data, especially single-cell gene expression data.
}
\examples{
# Generate simulated data with dropout
set.seed(123)
N <- 50  # cells
D <- 20  # genes

Y <- matrix(rpois(D * N, lambda = 5), nrow = D, ncol = N)
Y <- log2(Y + 1)
Y[sample(length(Y), floor(length(Y) * 0.3))] <- 0

# Fit ZIFA
result <- fit_zifa(Y, k = 2, verbose = FALSE)

}
